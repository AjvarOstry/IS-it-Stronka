<!DOCTYPE html>
<html lang="pl-PL">
    <head>
        <meta charset="utf-8">
        <title>IS-it-notateczki</title>
        <link rel="stylesheet" href="./styles/structure.min.css">
        <link rel="stylesheet" href="./styles/design.min.css">
        <link rel="stylesheet" href="./styles/markdown.min.css">

        <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
        <script src="./scripts/emojiMap.js"></script>
    </head>

    <body>
        <header>
            <h1>IS it?</h1>
        </header>
        
        <section>
            <nav class="box">
                
                <ul class="menu">
                    <li> <a href="#" data-md-file="docs/main.md"> > Strona główna</a></li>
                    <hr>
                    <li>Semestr 1</li>
                    <li class="ma-podmenu">
                        <a href="#">Semestr 2</a>
                        <ul class="podmenu">
                            <li><a href="#" data-md-file="./docs/Sem2/git-komendy.md">Git</a></li>
                            <li><a href="#" data-md-file="docs/sysodpowiedzi.md">SysOdpowiedzi</a></li>
                        </ul>

                    </li>
                        
                    <li>Semestr 3</li>
                    <hr>

                    <li class="ma-podmenu">
                        <a href="#">Różne takie</a>
                        <ul class="podmenu">
                            <li><a href="#" data-md-file="./docs/test-markdown.md">Testy</a></li>
                        </ul>

                    </li>
                </ul>
                
            </nav>

            <article id="md-screen" class="box">
                
            </article>
        </section>


        <script>

            // Funkcja zamiany shortcodes na emoji
            function renderEmojis(text) {
            return text.replace(/:[a-zA-Z0-9_-]+:/g, match => window.emojiMap[match] || match);
            }

            // Konfiguracja Marked z GFM
            marked.setOptions({
            gfm: true,
            breaks: true,
            });

             // Funkcja do wczytywania Markdown
            function loadMarkdown(file) {
            fetch(file)
                .then(response => {
                if (!response.ok) throw new Error('Nie można wczytać pliku');
                return response.text();
                })
                .then(text => {
                const renderedText = renderEmojis(marked.parse(text));
                document.getElementById('md-screen').innerHTML = renderedText;
                })
                .catch(error => {
                document.getElementById('md-screen').innerHTML = `<p>Błąd: ${error.message}</p>`;
                });
            }

            // Wczytaj domyślny plik po załadowaniu strony
            window.onload = () => {
            loadMarkdown('docs/main.md');
            };

            // Pobierz wszystkie linki z atrybutem data-md-file
            const links = document.querySelectorAll('.menu a[data-md-file]');
            links.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const mdFile = link.getAttribute('data-md-file');
                loadMarkdown(mdFile);
            });
            });
          </script>

    </body>
</html>
    